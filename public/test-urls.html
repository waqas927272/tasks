<!DOCTYPE html>
<html>
<head>
    <title>URL Test</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ddd; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
    </style>
</head>
<body>
    <h1>URL Test for Notifications</h1>
    
    <div id="tests"></div>
    
    <script>
        // Simple URL builder for testing
        function buildUrl(path) {
            const baseUrl = '/tasks';
            return baseUrl + '/' + path.replace(/^\/+/, '');
        }
        
        const tests = document.getElementById('tests');
        
        // Test URLs
        const urlsToTest = [
            'notifications/count',
            'notifications/recent',
            'notifications',
            'tasks'
        ];
        
        urlsToTest.forEach(path => {
            const div = document.createElement('div');
            div.className = 'test';
            
            const url = buildUrl(path);
            div.innerHTML = `
                <strong>Path:</strong> ${path}<br>
                <strong>Full URL:</strong> ${url}<br>
                <button onclick="testUrl('${url}')">Test</button>
                <span id="result-${path.replace(/\//g, '-')}"></span>
            `;
            
            tests.appendChild(div);
        });
        
        function testUrl(url) {
            const resultId = 'result-' + url.split('/').slice(-2).join('-');
            const resultSpan = document.getElementById(resultId);
            
            resultSpan.innerHTML = ' Testing...';
            
            fetch(url, {
                headers: { 'X-Requested-With': 'XMLHttpRequest' },
                credentials: 'same-origin'
            })
            .then(response => {
                if (response.ok) {
                    return response.json().then(data => {
                        resultSpan.innerHTML = ` ✓ Success: ${JSON.stringify(data)}`;
                        resultSpan.style.color = 'green';
                    });
                } else {
                    resultSpan.innerHTML = ` ✗ Error: ${response.status} ${response.statusText}`;
                    resultSpan.style.color = 'red';
                }
            })
            .catch(error => {
                resultSpan.innerHTML = ` ✗ Error: ${error.message}`;
                resultSpan.style.color = 'red';
            });
        }
        
        // Show current location info
        document.write('<div class="test">');
        document.write('<strong>Current Location:</strong><br>');
        document.write('Hostname: ' + window.location.hostname + '<br>');
        document.write('Pathname: ' + window.location.pathname + '<br>');
        document.write('Full URL: ' + window.location.href + '<br>');
        document.write('</div>');
    </script>
</body>
</html>